inside = "(?:\\[[^\\]]*\\]|[^\\]]|\\](?=[^\\[]*\\]))*"

module.exports =
  escape: ///^\\([\\`*{}\[\]()\#+\-.!_>~|])///
  autolink: /^<([^ >]+(@|:\/)[^ >]+)>/
  url: /^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/
  tag: /^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/

  link: ///^
    !?
    \[
      (#{inside}) # displayed text
    \]
    \(
      \s*
      <?
        ([\s\S]*?) # URL
      >?
      (?:\s+['"]([\s\S]*?)['"])? # title
      \s*
    \)
    ///

  reflink: ///^!?\[(#{inside})\]\s*\[([^\]]*)\]///
  nolink: /^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/
  strong: /^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/
  em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/
  code: /^(`+)([\s\S]*?[^`])\1(?!`)/
  br: /^ *\n(?!\s*$)/
  del: /^~~(?=\S)([\s\S]*?\S)~~/
  text: /^[\s\S]+?(?=[\\<!\[_*`~]|https?:\/\/| *\n|$)/
